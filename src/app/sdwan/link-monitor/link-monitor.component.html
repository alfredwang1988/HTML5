<div class="height-0">
  <app-link-monitor-detail #detail [selectedItem]="selectedItem"></app-link-monitor-detail>
  <app-monitor-chart [selectedItem]="selectedItem" #chartWin></app-monitor-chart>
</div>
<div class="title">VPE-PE链路监控</div>
<div class="content-menu">
  <app-link-monitor-search [searchInitObj]="searchInitObj" (done)="searchDone($event)"></app-link-monitor-search>
</div>
<div class="grid-wrapper">
  <app-grid class="s-grid" [data]="vpeLists" (selection-change)="showDetail($event)" [loading]="gridLoading">
    <app-grid-column field="number" header="序号"></app-grid-column>
    <app-grid-column field="sdwanNetworkUuid" header="所属网络UUID"></app-grid-column>
    <app-grid-column field="sdwanNetworkName" header="所属网络"></app-grid-column>
    <app-grid-column field="vpeName" header="VPE名称"></app-grid-column>
    <app-grid-column field="vpeIp" header="VPE IP"></app-grid-column>
    <app-grid-column field="peType" header="PE类型"></app-grid-column>
    <app-grid-column field="srcMonitorIp" header="srcMonitorIp"></app-grid-column>
    <app-grid-column field="destMonitorIp" header="destMonitorIp"></app-grid-column>

    <app-grid-column field="status" header="状态" width="100px">
      <ng-template #slot let-dataItem>
        <span *ngIf="dataItem.status === 'Connected'" class="label label-success">正常</span>
        <span *ngIf="dataItem.status === 'Disconnected'" class="label label-danger">异常</span>
        <span *ngIf="dataItem.status === 'Connecting'" class="label label-info">连接中</span>
        <span *ngIf="dataItem.peType !== 'Direct'" class="iconfont icon-chart link-monitor" (click)="openMonitor(dataItem, $event)"></span>
      </ng-template>
    </app-grid-column>

    <app-grid-column field="createDate" header="最后更新时间">
      <ng-template #slot let-dataItem>
        {{dataItem.lastOpDate | date: 'yyyy-MM-dd HH:mm:ss'}}
      </ng-template>
    </app-grid-column>

    <app-grid-column header="操作" width="80px">
      <ng-template #slot let-dataItem>
        <app-w-dropdown (click)="selectedRow(dataItem)">
          <ng-container drop-type="toggle">更多</ng-container>
          <ul drop-type="menu" class="grid-drop-menu">
            <li (click)="chartWin.open();">监控</li>
          </ul>
        </app-w-dropdown>
      </ng-template>
    </app-grid-column>

  </app-grid>

  <app-pagination *ngIf="pagination.show" [(pageSize)]="pagination.size" (pageSizeChange)="pageChange($event, true)"
                  [dataTotal]="pagination.total" [(currentPage)]="pagination.current"
                  (currentPageChange)="pageChange($event, false)" [layout]="pagination.layout"></app-pagination>
</div>
